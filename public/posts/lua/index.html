<!doctype html>







<html
  class="not-ready lg:text-base"
  style="--bg:#f8f5d7"
  lang="ja-jp"
  dir="ltr"
><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>Lua基本文法まとめ - morita&#39;s blog</title>

  
  <meta name="theme-color" />

  <meta name="description" content="Neovimなどの設定記述言語として使われているLua言語の基本文法
文字列

文字列の結合は..
[[string]]はエスケープ
string.format()でpythonのfstringのように文字列が作れる

変数

Luaの変数は基本的にグローバル
型は指定しないが存在はする(動的型付け)
型の種類

nil
boolean
number
string
function
userdata
thread
table



演算


四則演算

&#43;
-
*
/
%



比較演算

&lt;, &gt;
&lt;=, &gt;=
==, ~=



論理演算

and
or
not



I/O
io.write(): 標準出力への書き出し
io.read(): 標準入力からの読み込み
制御文
if文
if(exp) then
  ...
elseif(exp) then
  ...
else
  ...
end
while文
while (exp) do
  ...
end
for文

Numeric for

for init, end, inc do
  ...
end

Generic for

repeat文
まず&hellip;の処理が実行される" />
  <meta name="author" content="Kohei Morita" /><link rel="preload stylesheet" as="style" href="http://localhost:1313/main.min.css" />

  
  <link rel="preload" as="image" href="http://localhost:1313/theme.png" />

  <link rel="preload" as="image" href="https://pbs.twimg.com/profile_images/1815956684168441856/xfRCsBBh_400x400.jpg" />

  <link rel="preload" as="image" href="http://localhost:1313/twitter.svg" /><link rel="preload" as="image" href="http://localhost:1313/github.svg" /><link rel="preload" as="image" href="http://localhost:1313/rss.svg" />

  <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css"
  integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI"
  crossorigin="anonymous"
/>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js"
  integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t"
  crossorigin="anonymous"
></script>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js"
  integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
  crossorigin="anonymous"
></script><script>
  document.addEventListener('DOMContentLoaded', () =>
    renderMathInElement(document.body, {
      
      
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '$', right: '$', display: false },
      ],
      
      throwOnError: false,
    }),
  );
</script>


  
  <link
    rel="icon"
    href="http://localhost:1313/favicon.ico"
  />
  <link
    rel="apple-touch-icon"
    href="http://localhost:1313/apple-touch-icon.png"
  />

  <meta name="generator" content="Hugo 0.147.2">
</head>
<body
    class="bg-(--bg) text-black antialiased duration-200 ease-out [-webkit-tap-highlight-color:transparent] dark:text-white"
  ><header
  class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"
>
  <div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto">
    <a
      class="-translate-y-[1px] text-2xl font-medium"
      href="http://localhost:1313/"
      >morita&#39;s blog</a
    >
    <div
      class="btn-dark text-[0px] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8"
    role="button"
    aria-label="Menu"
  ></div>

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#f8f5d7'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center bg-(--bg) pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:bg-transparent! lg:pb-0 lg:transition-none"
  ><nav
      class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"
    ><a
        class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal"
        href="/about/"
        >About</a
      ><a
        class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal"
        href="/contact/"
        >Contact</a
      ></nav><nav
      class="mt-12 flex justify-center space-x-10 lg:mt-0 lg:items-center ltr:lg:ml-14 rtl:space-x-reverse rtl:lg:mr-14 dark:invert"
    >
      <a
        class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./twitter.svg)"
        href="https://twitter.com/@morita_kagshm"
        target="_blank"
        rel="me"
      >twitter</a>
      <a
        class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./github.svg)"
        href="https://github.com/moriT958"
        target="_blank"
        rel="me"
      >github</a>
      <a
        class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./rss.svg)"
        href="http://localhost:1313/index.xml"
        target="_blank"
        rel="alternate"
      >rss</a>
    </nav>
  </div>
</header>
<main
      class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-14 pb-16"
    ><article>
  <header class="mb-14">
    <h1 class="my-0! pb-2.5">Lua基本文法まとめ</h1><div class="text-xs antialiased opacity-60"><time>May 10, 2025</time></div></header>

  <section><p>Neovimなどの設定記述言語として使われているLua言語の基本文法</p>
<h2 id="文字列">文字列</h2>
<ul>
<li>文字列の結合は<code>..</code></li>
<li><code>[[string]]</code>はエスケープ</li>
<li><code>string.format()</code>でpythonのfstringのように文字列が作れる</li>
</ul>
<h2 id="変数">変数</h2>
<ul>
<li>Luaの変数は基本的にグローバル</li>
<li>型は指定しないが存在はする(動的型付け)</li>
<li>型の種類
<ul>
<li><code>nil</code></li>
<li><code>boolean</code></li>
<li><code>number</code></li>
<li><code>string</code></li>
<li><code>function</code></li>
<li><code>userdata</code></li>
<li><code>thread</code></li>
<li><code>table</code></li>
</ul>
</li>
</ul>
<h2 id="演算">演算</h2>
<ul>
<li>
<p>四則演算</p>
<ul>
<li><code>+</code></li>
<li><code>-</code></li>
<li><code>*</code></li>
<li><code>/</code></li>
<li><code>%</code></li>
</ul>
</li>
<li>
<p>比較演算</p>
<ul>
<li><code>&lt;, &gt;</code></li>
<li><code>&lt;=, &gt;=</code></li>
<li><code>==, ~=</code></li>
</ul>
</li>
<li>
<p>論理演算</p>
<ul>
<li><code>and</code></li>
<li><code>or</code></li>
<li><code>not</code></li>
</ul>
</li>
</ul>
<h2 id="io">I/O</h2>
<p><code>io.write()</code>: 標準出力への書き出し
<code>io.read()</code>: 標準入力からの読み込み</p>
<h2 id="制御文">制御文</h2>
<h3 id="if文">if文</h3>
<pre tabindex="0"><code class="language-:" data-lang=":">if(exp) then
  ...
elseif(exp) then
  ...
else
  ...
end
</code></pre><h3 id="while文">while文</h3>
<pre tabindex="0"><code class="language-:lua" data-lang=":lua">while (exp) do
  ...
end
</code></pre><h3 id="for文">for文</h3>
<ul>
<li>Numeric for</li>
</ul>
<pre tabindex="0"><code class="language-:lua" data-lang=":lua">for init, end, inc do
  ...
end
</code></pre><ul>
<li>Generic for</li>
</ul>
<h3 id="repeat文">repeat文</h3>
<p>まず&hellip;の処理が実行される</p>
<pre tabindex="0"><code class="language-:lua" data-lang=":lua">repeat
  ...
until (exp)
</code></pre><h3 id="break文">break文</h3>
<ul>
<li><code>break;</code></li>
<li>ブロックの最後(endの手前, untilの手前etc.)にしか書けない</li>
<li>それ以外の場所に書きたい場合以下のように無理やりブロックを作る</li>
</ul>
<pre tabindex="0"><code class="language-:lua" data-lang=":lua">do
  break;
end
</code></pre><h2 id="関数">関数</h2>
<pre tabindex="0"><code class="language-:lua" data-lang=":lua">function name(arg)
  ...
end
</code></pre><h2 id="標準ライブラリ">標準ライブラリ</h2>
<ul>
<li><code>assert(v, [, message])</code>: <code>v</code>が偽ならエラーを起こす</li>
<li><code>dofile(filename)</code>: ファイルを実行する</li>
<li><code>type(v)</code>: 型を返す</li>
<li><code>tonumber(e, [,base])</code>: base進数の数値へ変換(変換不可の場合nilを返す)</li>
<li><code>tostring(e)</code>: 文字列へ変換</li>
</ul>
<h2 id="luaスタック">Luaスタック</h2>
<ul>
<li>
<p>スタック型のデータ構造</p>
</li>
<li>
<p>Luaスタックを介してC言語間とのデータのやり取りができる</p>
</li>
<li>
<p>C言語でLuaを利用する場合、３つのヘッダファイルが必要。</p>
</li>
<li>
<p>lua_State*型の構造体LがLuaインタプリタの状態を保持する。</p>
</li>
<li>
<p>lua_close(L)で確保された動的メモリが全て解放される。</p>
</li>
</ul>
<pre tabindex="0"><code class="language-:c" data-lang=":c">#include &lt;stdio.h&gt;

#include &#34;lua.h&#34;
#include &#34;lualib.h&#34;
#include &#34;luaxlib.h&#34;

int main(void)
{
  lua_State* L = luaL_newstate();

  ...

  lua_close(L);
  return 0;
}
</code></pre><ul>
<li>Luaスタックへのプッシュ例</li>
</ul>
<pre tabindex="0"><code class="language-:c" data-lang=":c">lua_pushboolean(L, 1);
lua_pushnumber(L, 10.5);
lua_pushinteger(L, 3);
lua_pushstring(L, &#34;Hello world&#34;);
lua_pushnil(L);
</code></pre><ul>
<li>Luaスタックのサイズは、通常20に設定されている</li>
</ul>
</section>

  <footer class="mt-12 flex flex-wrap"><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="http://localhost:1313/tags/programming"
      >programming</a
    ></footer></article></main><footer
  class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"
>
  <div class="mr-auto">&copy;2025
    <a class="link" href="http://localhost:1313/">morita&#39;s blog</a></div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >powered by hugo️️</a
  >️
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >hugo-paper</a
  >
</footer>
</body>
</html>
